<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>My Portfolio</title>
  <link rel="stylesheet" href="style.css">

</head>
<body>
  <header>
    <h1>Gesang Project</h1>
    <p>Memories From A Simpler Time</p>
  </header>

  <section id="about">
    <h2>Description</h2>
    <p>Gesang, A Family Hard as Nails, Forged Through Time</p>
  </section>

  <section id="portfolio">
  <h2>Photos</h2>
  
  <!-- Gallery of images -->
  <div id="gallery"></div>

  <!-- Button to submit new image -->
  <div class="submit-button-container">
    <a href="https://docs.google.com/forms/d/e/1FAIpQLSd-Hu_RK1mP7gv0yoHDI50V0CWlZ4sO_4ojTgevwC6hlS5lOQ/viewform?usp=dialog" target="_blank">
      <button class="submit-button">Submit Your Image</button>
    </a>
  </div>
  </section>

  <section id="contact">
    <h2>Contact Me</h2>
    <p>Email: jhiroasia@gmail.com</p>
    <p>Phone : (+62) 0813 6373 8105</p>
  </section>

  <footer>
    <p>Â© 2025 Gesang</p>
  </footer>

  <!-- Script to fetch images from Google Sheet -->
  <script>
  const sheetUrl = "https://docs.google.com/spreadsheets/d/198Mkg77i3PwMyq8Dtn2YZsv1nJd5UIswpUzB8jYO1eg/gviz/tq?tqx=out:json&gid=1310056979";

  function convertDriveLink(url) {
    // If it's a Google Drive "file/d/ID/view" link, extract the ID
    const match = url.match(/\/d\/(.*?)\//);
    if (match && match[1]) {
      return `https://drive.google.com/uc?export=view&id=${match[1]}`;
    }
    return url; // return original if it's already direct
  }

  async function loadImages() {
    try {
      const res = await fetch(sheetUrl);
      const text = await res.text();
      const json = JSON.parse(text.substring(47, text.length - 2));

      const rows = json.table.rows;
      const gallery = document.getElementById("gallery");

      rows.forEach(row => {
        let url = row.c[1]?.v; // 2nd column
        if (url) {
          url = convertDriveLink(url);

          const img = document.createElement("img");
          img.src = url;
          img.loading = "lazy";

          // If image fails to load, warn in console & remove it
          img.onerror = () => {
            console.warn("Image failed to load:", url);
            img.remove();
          };

          gallery.appendChild(img);
          console.log("Loading image:", url); // Debug info
        }
      });
    } catch (err) {
      console.error("Error loading images:", err);
    }
  }

  loadImages();
</script>
</script>

</body>
</html>
